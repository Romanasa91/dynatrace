{
    "family": "dynatrace-task",
    "containerDefinitions": [
        {
            "command": [
                "apt-get update && apt-get install -y wget unzip && ARCHIVE=$(mktemp) && wget -O $ARCHIVE \"$DT_API_URL/v1/deployment/installer/agent/unix/paas/latest?arch=$ARCH&Api-Token=$DT_PAAS_TOKEN&$DT_ONEAGENT_OPTIONS\" && unzip -o -d /opt/dynatrace/oneagent $ARCHIVE && rm -f $ARCHIVE"
            ],
            "cpu": 0,
            "entryPoint": [
                "/bin/sh",
                "-c"
            ],
            "environment": [
                {
                    "name": "DT_PAAS_TOKEN",
                    "value": "dt0c01.2NZYR7WDIXOF3I5PJXAVHJPE.3MR2CEGBQXQA223J6K3OYFTBPA7VCGWUTTAANXTSJXRP4JZ4CF64E3QK5GX4OVDR"
                },
                {
                    "name": "ARCH",
                    "value": "x86"
                },
                {
                    "name": "DT_API_URL",
                    "value": "https://bls47110.live.dynatrace.com/api"
                },
                {
                    "name": "DT_ONEAGENT_OPTIONS",
                    "value": "flavor=default&include=all"
                }
            ],
            "essential": false,
            "image": "debian:latest",
            "logConfiguration": {
                "logDriver": "awslogs",
                "options": {
                    "awslogs-group": "/ecs/dynatrace-task",
                    "awslogs-region": "eu-central-1",
                    "awslogs-stream-prefix": "oneagent"
                }
            },
            "mountPoints": [
                {
                    "containerPath": "/opt/dynatrace/oneagent",
                    "readOnly": false,
                    "sourceVolume": "oneagent"
                }
            ],
            "name": "oneagent-installer",
            "portMappings": [],
            "systemControls": [],
            "volumesFrom": []
        },
        {
            "command": [
                "apt-get update && apt-get install -y python-is-python3 && python3 -c \"import http.server, json; http.server.SimpleHTTPRequestHandler.do_GET=lambda s: (s.send_response(200), s.send_header('Content-Type','application/json'), s.end_headers(), s.wfile.write(json.dumps({'status':'ok'}).encode())); http.server.HTTPServer(('',8080), http.server.SimpleHTTPRequestHandler).serve_forever()\""
            ],
            "cpu": 0,
            "dependsOn": [
                {
                    "condition": "COMPLETE",
                    "containerName": "oneagent-installer"
                }
            ],
            "entryPoint": [
                "/bin/sh",
                "-c"
            ],
            "environment": [
                {
                    "name": "LD_PRELOAD",
                    "value": "/opt/dynatrace/oneagent/agent/lib64/liboneagentproc.so"
                },
                {
                    "name": "DT_LOGLEVELCON",
                    "value": "info"
                }
            ],
            "essential": true,
            "image": "debian:latest",
            "logConfiguration": {
                "logDriver": "awslogs",
                "options": {
                    "awslogs-group": "/ecs/dynatrace-task",
                    "awslogs-region": "eu-central-1",
                    "awslogs-stream-prefix": "app"
                }
            },
            "mountPoints": [
                {
                    "containerPath": "/opt/dynatrace/oneagent",
                    "readOnly": false,
                    "sourceVolume": "oneagent"
                }
            ],
            "name": "app",
            "portMappings": [],
            "systemControls": [],
            "volumesFrom": []
        }
    ],
    "taskRoleArn": "arn:aws:iam::509615516105:role/ecsTaskRole-dynatrace",
    "executionRoleArn": "arn:aws:iam::509615516105:role/ecsTaskExecutionRole-dynatrace",
    "networkMode": "awsvpc",
    "volumes": [
        {
            "host": {},
            "name": "oneagent"
        }
    ],
    "placementConstraints": [],
    "requiresCompatibilities": [
        "FARGATE"
    ],
    "cpu": "512",
    "memory": "1024"
}
